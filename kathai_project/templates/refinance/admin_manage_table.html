{% extends "base.html" %}
{% load refinance_tags %}
{% block title %}จัดการ {{ model_name }}{% endblock %}

{% block content %}
<div class="card card-ghost p-4">

  <!-- Header: Table title -->
  <div class="d-flex justify-content-center mb-4">
    <h2 class="title mb-0">ตาราง {{ model_name }}</h2>
  </div>

  <!-- ปุ่มเพิ่ม -->
  <div class="d-flex justify-content-end mb-3" style="margin-right: 160px;">
    <a href="{% url 'refinance:generic_object_add' model_name=model_name_for_form %}"
       class="btn btn-success d-inline-flex align-items-center px-3 py-2" style="min-width: 80px; min-height: 50px; border-radius: 10px;">
      <i class="bi bi-plus-lg me-1"></i> เพิ่ม
    </a>
  </div>

  <!-- Table -->
  <div class="table-responsive" style="overflow-x:auto;">
    <table class="table table-striped table-bordered align-middle text-sm mx-auto"
           style="width: 1100px; max-width: 100%;">
      <thead class="table-light">
        <tr>
          <th width="80px">ID</th>
          {% if model_name == "UserProfile" %}
            <th>Phone Number</th>
          {% else %}
            <th>{{ fields.0 }}</th>
          {% endif %}
          <th width="250px">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for obj in objects %}
        <tr>
          <td>{{ obj.id }}</td>
          {% if model_name == "UserProfile" %}
            <td>{{ obj.phone_number }}</td>
          {% else %}
            <td>{{ obj|get_attr:fields.0 }}</td>
          {% endif %}
          <td>
            <div class="d-flex gap-2 flex-wrap">
              <!-- Edit -->
              <a href="{% if model_name == 'UserProfile' %}
                          {% url 'refinance:generic_object_detail' model_name='UserProfile' object_id=obj.id %}
                        {% else %}
                          {% url 'refinance:generic_object_detail' model_name=model_name_for_form object_id=obj.id %}
                        {% endif %}"
                 class="btn btn-outline-primary btn-sm d-inline-flex align-items-center">
                <i class="bi bi-pencil me-1"></i> แก้ไข
              </a>

              <a href="{% url 'refinance:generic_object_delete' model_name=model_name_for_form object_id=obj.id %}"
                onclick="return confirm('คุณต้องการลบข้อมูลนี้จริงหรือไม่?');"
                class="btn btn-outline-dark btn-sm d-inline-flex align-items-center justify-content-center"
                style="min-width: 100px; min-height: 50px; border-radius: 10px;">
                <i class="bi bi-trash me-1"></i> ลบ
            </a>
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="3" class="text-center text-muted py-3">ไม่พบข้อมูล</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
